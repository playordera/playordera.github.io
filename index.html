<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Altera</title>
<style>
  :root {
    --c1:#4facfe; --c2:#ff6b6b; --c3:#fbc531; --c4:#24e07f;
    --bg:#0d1b2a;
    --tile1:#4a90e2; --tile2:#50e3c2; --tile3:#f5a623; --tile4:#d0021b;
  }
  body {
    margin:0;
    font-family: 'Trebuchet MS', sans-serif;
    background: linear-gradient(135deg,#1e2a47,#0d1b2a);
    color:white; text-align:center;
    display:flex; flex-direction:column;
    min-height:100vh; overflow:hidden;
  }
  header { padding:10px 0 0; }
  .logo {
    font-size:2.8em; font-weight:900;
    background: linear-gradient(90deg,var(--c1),var(--c2),var(--c3),var(--c4),var(--c1));
    -webkit-background-clip:text; -webkit-text-fill-color:transparent;
    background-clip:text;
    background-size:300% auto;
    animation: logoFade 18s linear infinite;
  }
  @keyframes logoFade {
    0%{background-position:0% 50%}100%{background-position:100% 50%}
  }
  .subtitle { font-size:1em; margin:0; }
  .puzzle-count { font-size:1em; margin:5px 0 10px; color:#ddd; }

  .tiles {
    display:grid; grid-template-columns:repeat(2,1fr);
    gap:12px; padding:0 20px; flex-grow:1;
    justify-content:center; align-content:center;
  }
  .tile {
    display:flex; justify-content:center; align-items:center;
    font-size:1.4em; font-weight:bold;
    border-radius:12px; min-height:110px;
    cursor:pointer; transition:transform .2s,box-shadow .2s,background .2s;
  }
  .tile:active { transform:scale(.95); }
  .correct { background:#22c55e!important; color:white!important; }
  .wrong { background:#ef4444!important; color:white!important; }

  /* Level 3 subtle glow */
  .lvl3 { animation: softGlow 4s ease-in-out infinite; }
  .lvl3:nth-child(2){animation-delay:1s;}
  .lvl3:nth-child(3){animation-delay:2s;}
  .lvl3:nth-child(4){animation-delay:3s;}
  @keyframes softGlow {
    0%,100%{box-shadow:0 0 6px rgba(255,255,255,.3);}
    50%{box-shadow:0 0 22px rgba(255,255,255,.7);}
  }

  .overlay {
    position:fixed;top:0;left:0;right:0;bottom:0;
    background:rgba(0,0,0,0.85);display:none;
    flex-direction:column;justify-content:center;align-items:center;
    padding:20px;z-index:10;
  }
  .overlay.show{display:flex;}
  .overlay h1{font-size:2em;margin:0 0 10px;}
  .overlay p{font-size:1.2em;}

  .overlay button{
    margin-top:15px;padding:12px 24px;font-size:1em;
    border:none;border-radius:8px;cursor:pointer;
    background:#22c55e;color:white;font-weight:bold;
  }

  .end-screen h1{font-size:2.2em;margin-bottom:15px;}
  .end-icons{font-size:3em;margin-bottom:10px;}
  .end-icons span{margin:0 10px;}
  .share-btn{
    padding:12px 24px;font-size:1.1em;
    border:none;border-radius:8px;cursor:pointer;
    background:#4a90e2;color:white;font-weight:bold;margin-top:15px;
  }

  footer{font-size:.8em;padding:8px 0;line-height:1.4;}
</style>
</head>
<body>
  <header>
    <div class="logo">ALTERA</div>
    <div class="subtitle">FIND THE ODD ONE OUT</div>
    <div class="puzzle-count">Puzzle 1/3</div>
  </header>
  <div class="tiles"></div>

  <div class="overlay" id="feedback">
    <h1 id="result"></h1>
    <p id="explanation"></p>
    <button id="continueBtn">Continue</button>
  </div>

  <div class="overlay end-screen" id="end">
    <div class="end-icons" id="endIcons"></div>
    <h1 id="endText">Game Over</h1>
    <button class="share-btn" id="shareBtn">Share</button>
  </div>

  <footer>
    <div id="seedLine"></div>
    <div id="dateLine"></div>
    <div id="streakLine">ðŸ”¥ Streak: 0 (Best: 0)</div>
  </footer>

<script>
let puzzles=[];
let today=new Date();
let seed=today.getFullYear()+""+String(today.getMonth()+1).padStart(2,'0')+String(today.getDate()).padStart(2,'0');
let dateStr=today.toISOString().split('T')[0];
let puzzleIndex=0;
let streak=parseInt(localStorage.getItem("streak")||0);
let best=parseInt(localStorage.getItem("bestStreak")||0);

const tilesDiv=document.querySelector(".tiles"),
feedback=document.getElementById("feedback"),
result=document.getElementById("result"),
explanation=document.getElementById("explanation"),
continueBtn=document.getElementById("continueBtn"),
end=document.getElementById("end"),
endIcons=document.getElementById("endIcons"),
endText=document.getElementById("endText"),
shareBtn=document.getElementById("shareBtn"),
seedLine=document.getElementById("seedLine"),
dateLine=document.getElementById("dateLine"),
streakLine=document.getElementById("streakLine");

seedLine.textContent="Seed: "+seed;
dateLine.textContent="Date: "+dateStr;

function renderPuzzle(){
  document.querySelector(".puzzle-count").textContent=`Puzzle ${puzzleIndex+1}/3`;
  tilesDiv.innerHTML="";
  let p=puzzles[puzzleIndex];
  let shuffled=[...p.words].sort(()=>Math.random()-.5);
  shuffled.forEach((w,i)=>{
    let t=document.createElement("div");
    t.className="tile lvl"+(puzzleIndex+1);
    t.style.background=[ "var(--tile1)","var(--tile2)","var(--tile3)","var(--tile4)" ][i%4];
    t.textContent=w;
    t.onclick=()=>check(w,t);
    tilesDiv.appendChild(t);
  });
}
function check(choice,tile){
  let p=puzzles[puzzleIndex];
  document.querySelectorAll(".tile").forEach(x=>x.style.pointerEvents="none");
  if(choice===p.odd){
    tile.classList.add("correct");
    showFeedback(true,p.explanation);
  }else{
    tile.classList.add("wrong");
    showFeedback(false,p.explanation);
  }
}
function showFeedback(ok,ex){
  feedback.classList.add("show");
  result.innerHTML= ok ? "<span style='color:#22c55e'>âœ” CORRECT</span>" :
                         "<span style='color:#ef4444'>âœ– WRONG</span>";
  explanation.textContent=ex;
}
continueBtn.onclick=()=>{
  feedback.classList.remove("show");
  if(++puzzleIndex<3){renderPuzzle();}
  else{finish(true);}
};
function finish(win){
  end.classList.add("show");
  if(win){
    streak++; if(streak>best) best=streak;
    localStorage.setItem("streak",streak);
    localStorage.setItem("bestStreak",best);
    endIcons.innerHTML="<span style='color:#22c55e'>âœ”âœ”âœ”</span>";
    endText.textContent="You Win!";
  }else{
    streak=0; localStorage.setItem("streak",0);
    endIcons.innerHTML="<span style='color:#ef4444'>âœ–</span>";
    endText.textContent="Game Over";
  }
  streakLine.textContent=`ðŸ”¥ Streak: ${streak} (Best: ${best})`;
}
shareBtn.onclick=()=>{
  let msg=`I played Altera and ${puzzleIndex>=3?"won all 3!":"lost at "+(puzzleIndex+1)+"/3."} ðŸ”— playordera.github.io`;
  if(navigator.share){navigator.share({text:msg});}
  else{navigator.clipboard.writeText(msg);alert("Copied share text!");}
};

fetch("puzzles.json")
.then(res=>res.json())
.then(data=>{
  let dayIndex=parseInt(seed)%data.length;
  puzzles=data[dayIndex];
  puzzleIndex=0;
  renderPuzzle();
  streakLine.textContent=`ðŸ”¥ Streak: ${streak} (Best: ${best})`;
});
</script>
</body>
</html>