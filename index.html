<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Altera â€” Daily Logic Game</title>
<link href="https://fonts.googleapis.com/css2?family=Bungee&display=swap" rel="stylesheet">

<style>
:root {
  --fg: #fff;
  --radius: 12px;
  --c1: #4f46e5; --c2: #0ea5e9; --c3: #e11d48; --c4: #f59e0b;
  --correct: #10b981; --wrong: #ef4444;
}

/* Background */
body {
  margin:0; padding:0;
  font-family:'Bungee', sans-serif;
  background:#0f172a;
  color:var(--fg);
  display:flex; flex-direction:column;
  height:100vh; overflow:hidden;
}

/* Header */
header { text-align:center; padding:4px; }
.logo {
  font-size:52px; margin:0;
  color: var(--c1);
  animation: cycleColors 12s linear infinite, logoPulse 6s ease-in-out infinite;
}
@keyframes cycleColors {
  0% { color: var(--c1); }
  25% { color: var(--c2); }
  50% { color: var(--c3); }
  75% { color: var(--c4); }
  100% { color: var(--c1); }
}
@keyframes logoPulse {
  0%,100% {transform:scale(1);}
  50% {transform:scale(1.03);}
}
header h2 { font-size:15px; margin:2px 0 2px; font-weight:400; opacity:0.85; }
#progress { font-size:14px; opacity:0.75; margin-bottom:8px; }

/* Game area centered */
#game { 
  flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center;
  padding:0 20px; 
}
#options { display:grid; grid-template-columns:repeat(2,1fr); gap:16px; width:100%; max-width:420px; }

/* Tiles */
.option {
  display:flex; align-items:center; justify-content:center;
  border-radius:var(--radius);
  font-size:22px; text-align:center;
  cursor:pointer; user-select:none;
  aspect-ratio:1/1; color:#fff; padding:10px;
  perspective:1000px;
  transition:transform 0.2s ease;
  position:relative; overflow:hidden;
}
.option span { display:block; }

/* Level 1 (easy): solid only */
.option.lvl1::after { content:""; }

/* Level 2 (medium): static patterns */
.option.lvl2.pattern-stripes::after {
  content:"";position:absolute;inset:0;
  background-image:repeating-linear-gradient(45deg, rgba(255,255,255,0.1) 0, rgba(255,255,255,0.1) 1px, transparent 1px, transparent 10px);
}
.option.lvl2.pattern-dots::after {
  content:"";position:absolute;inset:0;
  background-image:radial-gradient(rgba(255,255,255,0.12) 1.5px, transparent 1.5px);
  background-size:14px 14px;
}
.option.lvl2.pattern-grid::after {
  content:"";position:absolute;inset:0;
  background-image:repeating-linear-gradient(90deg, rgba(255,255,255,0.1) 0, rgba(255,255,255,0.1) 2px, transparent 2px, transparent 14px);
}

/* Level 3 (hard): animated patterns */
.option.lvl3.pattern-slide::after {
  content:"";position:absolute;inset:0;
  background-image:repeating-linear-gradient(45deg, rgba(255,255,255,0.12) 0, rgba(255,255,255,0.12) 2px, transparent 2px, transparent 12px);
  animation: slideBg 6s linear infinite;
}
.option.lvl3.pattern-drift::after {
  content:"";position:absolute;inset:0;
  background-image:radial-gradient(rgba(255,255,255,0.15) 2px, transparent 2px);
  background-size:16px 16px;
  animation: driftBg 8s linear infinite;
}
.option.lvl3.pattern-shift::after {
  content:"";position:absolute;inset:0;
  background:linear-gradient(135deg, rgba(255,255,255,0.1) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.1) 75%, transparent 75%, transparent);
  background-size:20px 20px;
  animation: shiftBg 10s linear infinite;
}
@keyframes slideBg { from{background-position:0 0;} to{background-position:40px 40px;} }
@keyframes driftBg { from{background-position:0 0;} to{background-position:0 40px;} }
@keyframes shiftBg { from{background-position:0 0;} to{background-position:40px 0;} }

/* Flip animations */
.option.flip { animation: flipTile 0.6s forwards; }
.option.correct { background:var(--correct)!important; }
.option.wrong { background:var(--wrong)!important; }
@keyframes flipTile {0%{transform:rotateY(0);}50%{transform:rotateY(90deg);}100%{transform:rotateY(0);}}

/* Overlay + footer remain same as last build */
#feedbackOverlay {
  position:fixed; inset:0; display:none;
  align-items:center; justify-content:center; flex-direction:column;
  background:rgba(0,0,0,0.92); z-index:100; text-align:center; padding:20px;
}
#feedbackOverlay.correct .symbol{color:var(--correct);}
#feedbackOverlay.wrong .symbol{color:var(--wrong);}
#feedbackOverlay .symbol{font-size:100px;font-weight:900;margin-bottom:18px;}
#feedbackOverlay .text{font-size:36px;font-weight:800;margin-bottom:14px;}
#feedbackOverlay .explanation{font-size:18px;max-width:360px;margin-bottom:20px;}
#feedbackOverlay button{padding:14px 26px;border:none;border-radius:var(--radius);background:var(--c1);color:#fff;font-size:18px;cursor:pointer;transition:transform 0.2s ease;}
#feedbackOverlay button:hover{transform:scale(1.08);}
footer { text-align:center; font-size:12px; opacity:0.85; padding:6px; position:absolute; bottom:0; width:100%; line-height:1.4em; }
.hidden { display:none; }
</style>
</head>

<body>
<header>
  <h1 class="logo" id="logo">ALTERA</h1>
  <h2>Find the odd one out</h2>
  <div id="progress"></div>
</header>

<div id="game">
  <div id="options"></div>
  <div id="endScreen" class="hidden">
    <div id="summary"></div>
    <button class="primary hidden" id="shareBtn">Share</button>
  </div>
</div>

<div id="feedbackOverlay">
  <div class="symbol"></div>
  <div class="text"></div>
  <div class="explanation"></div>
  <button id="continueBtn">Continue</button>
</div>

<footer id="footerInfo"></footer>

<script>
const DATA_URL = "puzzles.json"; 
const DIFFICULTIES = ["easy","medium","hard"];
const tz = "America/Edmonton";

let puzzles=[], todaySet=[], currentIndex=0, results=[];
let pendingCallback=null;
let streakData = { current: 0, best: 0, lastDate: null };

function loadStreak(){ const data=localStorage.getItem("altera_streak"); if(data){ streakData=JSON.parse(data);} }
function saveStreak(){ localStorage.setItem("altera_streak", JSON.stringify(streakData)); }
function toYMD(date, tz){ const z=new Date(date.toLocaleString('en-US',{timeZone:tz})); return `${z.getFullYear()}${String(z.getMonth()+1).padStart(2,'0')}${String(z.getDate()).padStart(2,'0')}`;}
function mulberry32(a){return function(){let t=a+=0x6D2B79F5;t=Math.imul(t^t>>>15,t|1);t^=t+Math.imul(t^t>>>7,t|61);return((t^t>>>14)>>>0)/4294967296;}}
function seededPick(rng, arr){return arr[Math.floor(rng()*arr.length)];}
function shuffleArray(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr;}

const optEl=document.getElementById("options");
const progressEl=document.getElementById("progress");
const footerInfo=document.getElementById("footerInfo");

async function loadData(){
  const res=await fetch(DATA_URL);
  const data=await res.json();
  puzzles=data.themes;
  setupDaily();
}

function setupDaily(){
  const seed=toYMD(new Date(),tz);
  const rng=mulberry32(Number(seed));
  todaySet=DIFFICULTIES.map(diff=>{
    const pool=puzzles.filter(p=>p.difficulty===diff);
    return seededPick(rng,pool);
  });
  updateFooter(seed);
  startPuzzle(0);
}

function updateFooter(seed){
  const today=new Date().toLocaleDateString('en-CA',{timeZone:tz});
  footerInfo.innerHTML=`Seed: ${seed}<br>Date: ${today}<br>ðŸ”¥ Streak: ${streakData.current} (Best: ${streakData.best})`;
}

function startPuzzle(i){
  currentIndex=i;
  progressEl.textContent=`Puzzle ${i+1}/3`;
  const p=todaySet[i];
  let shuffled=shuffleArray([...p.items]);
  optEl.innerHTML="";
  shuffled.forEach(item=>{
    const div=document.createElement("div");
    div.className="option lvl"+(i+1); // lvl1, lvl2, lvl3
    div.classList.add(i===1 ? "pattern-dots" : i===2 ? "pattern-slide" : ""); 
    div.style.backgroundColor = [getComputedStyle(document.documentElement).getPropertyValue('--c1'), '--c2','--c3','--c4'][Math.floor(Math.random()*4)];
    div.innerHTML=`<span>${item}</span>`;
    div.onclick=()=>choose(div,item,p);
    optEl.appendChild(div);
  });
}

// choose(), overlay, streak, finishGame remain same as before...

</script>
</body>
</html>